apiVersion: v1
kind: Pod
spec:
  shareProcessNamespace: true
  containers:
    - name: sa-spark-driver-wordcount
      env:
        - name: NAME
          value: "Vijay-sa-spark-driver-wordcount"
        - name: POD_UID
          valueFrom:
            fieldRef:
              fieldPath: metadata.uid
      livenessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - echo healthy at $(date) > /logging-volume/healthy
      volumeMounts:
        - name: logging-volume
          mountPath: /logging-volume
    - name: pods-vjbox-container
      env:
        - name: NAME
          value: "Vijay-pods-vjbox-container"
        - name: POD_UID
          valueFrom:
            fieldRef:
              fieldPath: metadata.uid
      image: vdonthireddy/vjbox:2.0
      args:
        - /bin/sh
        - -c
        - while :; do echo "healthcheck" > /logging-volume/pods-vjbox-container.txt; sleep 10 ; done
      volumeMounts:
        - name: logging-volume
          mountPath: /logging-volume
    - name: observerbox
      env:
        - name: NAME
          value: "Vijay-observerbox"
        - name: POD_UID
          valueFrom:
            fieldRef:
              fieldPath: metadata.uid
      image: vdonthireddy/observerbox:centos
      args:
        - /bin/bash
        - ./terminate.sh
      volumeMounts:
        - name: logging-volume
          mountPath: /logging-volume
  volumes:
    - name: logging-volume
      emptyDir: {}
